# backend/app/schemas/vulnerability.py
from pydantic import BaseModel
from typing import Optional
from datetime import datetime
from typing import List
from app.schemas.cve_description import CveDescriptionResponse, CveDescriptionCreate

class VulnerabilityCreate(BaseModel):
    cve_id: str
    source_identifier: Optional[str] = None
    published: Optional[datetime] = None
    last_modified: Optional[datetime] = None
    status: Optional[str] = None
    cwe: Optional[str] = None
    cvss_version: Optional[str] = None
    score: Optional[str] = None
    vector: Optional[str] = None
    severity: Optional[str] = None

    exploitability_score: Optional[float] = None
    impact_score: Optional[float] = None
    user_interaction_required: Optional[bool] = None
    obtain_all_privileges: Optional[bool] = None
    obtain_user_privileges: Optional[bool] = None
    obtain_other_privileges: Optional[bool] = None

    attack_vector: Optional[str] = None
    attack_complexity: Optional[str] = None
    privileges_required: Optional[str] = None
    user_interaction: Optional[str] = None
    scope: Optional[str] = None
    confidentiality_impact: Optional[str] = None
    integrity_impact: Optional[str] = None
    availability_impact: Optional[str] = None

    access_vector: Optional[str] = None
    access_complexity: Optional[str] = None
    authentication: Optional[str] = None
    descriptions: Optional[List[CveDescriptionCreate]] = None


class VulnerabilityUpdate(BaseModel):
    source_identifier: Optional[str] = None
    published: Optional[datetime] = None
    last_modified: Optional[datetime] = None
    status: Optional[str] = None
    cvss_score: Optional[str] = None
    cvss_vector: Optional[str] = None
    severity: Optional[str] = None
    cvss_version: Optional[str] = None
    cwe: Optional[str] = None

class VulnerabilityResponse(VulnerabilityCreate):
    id: int
