from pydantic import BaseModel
from typing import Optional
from datetime import datetime
from typing import List
from app.schemas.cve_description import CveDescriptionResponse, CveDescriptionCreate

class VulnerabilityCreate(BaseModel):
    cve_id: str
    source_identifier: Optional[str] = None
    published: Optional[datetime] = None
    last_modified: Optional[datetime] = None
    status: Optional[str] = None
    cvss_score: Optional[str] = None
    cvss_vector: Optional[str] = None
    severity: Optional[str] = None
    cwe: Optional[str] = None
    descriptions: Optional[List[CveDescriptionCreate]] = None


class VulnerabilityUpdate(BaseModel):
    source_identifier: Optional[str] = None
    published: Optional[datetime] = None
    last_modified: Optional[datetime] = None
    status: Optional[str] = None
    cvss_score: Optional[str] = None
    cvss_vector: Optional[str] = None
    severity: Optional[str] = None
    cwe: Optional[str] = None

class VulnerabilityResponse(VulnerabilityCreate):
    id: int
